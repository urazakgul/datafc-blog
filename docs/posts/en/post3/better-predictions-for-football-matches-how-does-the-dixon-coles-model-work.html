<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Uraz Akgül">
<meta name="dcterms.date" content="2025-02-16">

<title>Better Predictions for Football Matches: How Does the Dixon-Coles Model Work? – datafc Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-f3c2ea88cadbcfb37ba28ffa2c97cfc1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-ae2d0dcda2edce4ab590422bb373b64f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">datafc Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/tr/index.html"> 
<span class="menu-text">Türkçe</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/en/index.html"> 
<span class="menu-text">English</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/urazdev" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/urazdev" target="_blank"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/urazakgul/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Better Predictions for Football Matches: How Does the Dixon-Coles Model Work?</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Model</div>
                <div class="quarto-category">Prediction</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Uraz Akgül </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 16, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dixon-coles-model" id="toc-dixon-coles-model" class="nav-link active" data-scroll-target="#dixon-coles-model">Dixon-Coles Model</a>
  <ul>
  <li><a href="#theoretical-foundations-of-the-dixon-coles-model" id="toc-theoretical-foundations-of-the-dixon-coles-model" class="nav-link" data-scroll-target="#theoretical-foundations-of-the-dixon-coles-model">Theoretical Foundations of the Dixon-Coles Model</a>
  <ul class="collapse">
  <li><a href="#poisson-distribution-and-football-matches" id="toc-poisson-distribution-and-football-matches" class="nav-link" data-scroll-target="#poisson-distribution-and-football-matches">Poisson Distribution and Football Matches</a></li>
  <li><a href="#parameters-of-the-dixon-coles-model" id="toc-parameters-of-the-dixon-coles-model" class="nav-link" data-scroll-target="#parameters-of-the-dixon-coles-model">Parameters of the Dixon-Coles Model</a></li>
  <li><a href="#mathematical-formulation-of-the-model" id="toc-mathematical-formulation-of-the-model" class="nav-link" data-scroll-target="#mathematical-formulation-of-the-model">Mathematical Formulation of the Model</a></li>
  <li><a href="#correction-factor-tau_lambdamuxy" id="toc-correction-factor-tau_lambdamuxy" class="nav-link" data-scroll-target="#correction-factor-tau_lambdamuxy">Correction Factor <span class="math inline">\(\tau_{\lambda,\mu}(x,y)\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#practical-example" id="toc-practical-example" class="nav-link" data-scroll-target="#practical-example">Practical Example</a>
  <ul>
  <li><a href="#season-matchweek-24-predictions" id="toc-season-matchweek-24-predictions" class="nav-link" data-scroll-target="#season-matchweek-24-predictions">2024/25 Season – Matchweek 24 Predictions</a>
  <ul class="collapse">
  <li><a href="#loading-required-libraries" id="toc-loading-required-libraries" class="nav-link" data-scroll-target="#loading-required-libraries">Loading Required Libraries</a></li>
  <li><a href="#preparing-the-dataset" id="toc-preparing-the-dataset" class="nav-link" data-scroll-target="#preparing-the-dataset">Preparing the Dataset</a></li>
  <li><a href="#rho_correction-function" id="toc-rho_correction-function" class="nav-link" data-scroll-target="#rho_correction-function"><code>rho_correction</code> Function</a></li>
  <li><a href="#dc_log_like-function" id="toc-dc_log_like-function" class="nav-link" data-scroll-target="#dc_log_like-function"><code>dc_log_like</code> Function</a></li>
  <li><a href="#solve_parameters-function" id="toc-solve_parameters-function" class="nav-link" data-scroll-target="#solve_parameters-function"><code>solve_parameters</code> Function</a></li>
  <li><a href="#dixon_coles_simulate_match-function" id="toc-dixon_coles_simulate_match-function" class="nav-link" data-scroll-target="#dixon_coles_simulate_match-function"><code>dixon_coles_simulate_match</code> Function</a></li>
  <li><a href="#running-the-code" id="toc-running-the-code" class="nav-link" data-scroll-target="#running-the-code">Running the Code</a></li>
  <li><a href="#interpreting-the-parameters" id="toc-interpreting-the-parameters" class="nav-link" data-scroll-target="#interpreting-the-parameters">Interpreting the Parameters</a>
  <ul class="collapse">
  <li><a href="#teams-attacking-strengths-attack_" id="toc-teams-attacking-strengths-attack_" class="nav-link" data-scroll-target="#teams-attacking-strengths-attack_">Teams’ Attacking Strengths (attack_*)</a></li>
  <li><a href="#teams-defensive-strengths-defence_" id="toc-teams-defensive-strengths-defence_" class="nav-link" data-scroll-target="#teams-defensive-strengths-defence_">Teams’ Defensive Strengths (defence_*)</a></li>
  <li><a href="#home-advantage-home_adv" id="toc-home-advantage-home_adv" class="nav-link" data-scroll-target="#home-advantage-home_adv">Home Advantage (<code>home_adv</code>)</a></li>
  <li><a href="#dependency-parameter-rho" id="toc-dependency-parameter-rho" class="nav-link" data-scroll-target="#dependency-parameter-rho">Dependency Parameter (<span class="math inline">\(\rho\)</span>)</a></li>
  </ul></li>
  <li><a href="#visualizing-the-results" id="toc-visualizing-the-results" class="nav-link" data-scroll-target="#visualizing-the-results">Visualizing the Results</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="dixon-coles-model" class="level1">
<h1>Dixon-Coles Model</h1>
<p>Developed by Mark J. Dixon and Stuart G. Coles in 1997, the Dixon-Coles model improves the modeling of dependencies in low-scoring matches by incorporating a correction factor into the traditional Poisson regression. This model has become significant in the field, particularly for improving the accuracy of predicting rare scores.</p>
<p>Dixon and Coles’ paper, <em>Modelling Association Football Scores and Inefficiencies in the Football Betting Market</em>, serves as the foundation of this methodology. The model estimates teams’ attacking and defensive strengths to calculate the possible score distributions for a given match.</p>
<p><img src="imgs/img1.PNG" class="img-fluid"></p>
<p>In this article, we will explore the theoretical foundations of the Dixon-Coles model in detail. We will delve into its mathematical structure, examine the parameter estimation process, and walk through a step-by-step implementation in Python. During the implementation, we will focus on preparing the dataset, optimizing the model, and interpreting the results.</p>
<section id="theoretical-foundations-of-the-dixon-coles-model" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-foundations-of-the-dixon-coles-model">Theoretical Foundations of the Dixon-Coles Model</h2>
<p>The Dixon-Coles model is a statistical approach that utilizes the Poisson distribution to predict football match outcomes. It quantifies each team’s attacking and defensive strengths using mathematical parameters and applies them to estimate potential score distributions for a given match. Unlike the traditional Poisson model, the Dixon-Coles model includes an additional correction factor to better capture dependencies in low-scoring matches. This adjustment improves the model’s predictive accuracy, leading to more realistic outcomes.</p>
<section id="poisson-distribution-and-football-matches" class="level3">
<h3 class="anchored" data-anchor-id="poisson-distribution-and-football-matches">Poisson Distribution and Football Matches</h3>
<p>The Poisson distribution is commonly used to model the number of events occurring within a fixed time interval and is frequently applied to predict the number of goals a team scores in football matches. However, the traditional Poisson model assumes that a team’s goal-scoring tendencies are independent of its opponent’s performance. Dixon and Coles showed that this assumption fails in low-scoring matches and introduced a correction factor (<span class="math inline">\(\tau\)</span>) to adjust the model.</p>
<p>The probability of a team scoring a given number of goals is expressed as:</p>
<p><span class="math inline">\(P(X=k)=\frac{e^{-\lambda}\lambda^k}{k!}\)</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(λ\)</span>: The team’s expected number of goals</li>
<li><span class="math inline">\(k\)</span>: The number of goals scored by the team</li>
</ul>
</section>
<section id="parameters-of-the-dixon-coles-model" class="level3">
<h3 class="anchored" data-anchor-id="parameters-of-the-dixon-coles-model">Parameters of the Dixon-Coles Model</h3>
<p>The Dixon-Coles model is a Poisson-based regression model designed to estimate each team’s attacking strength (<span class="math inline">\(\alpha\)</span>) and defensive capability (<span class="math inline">\(\beta\)</span>). The model also incorporates home advantage (<span class="math inline">\(\gamma\)</span>) as an additional factor. Its key innovation is the <span class="math inline">\(\tau\)</span> correction factor, which accounts for the dependency between teams’ goal-scoring tendencies. This correction factor is particularly useful for improving the modeling of low-scoring matches (e.g., 0-0, 1-0, 0-1, 1-1).</p>
</section>
<section id="mathematical-formulation-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-formulation-of-the-model">Mathematical Formulation of the Model</h3>
<p>The Dixon-Coles model relies on the Poisson distribution to estimate the home team’s goal count <span class="math inline">\(X\)</span> and the away team’s goal count <span class="math inline">\(Y\)</span>. However, unlike the traditional Poisson model, it introduces the <span class="math inline">\(\tau\)</span> correction factor to account for dependencies in low-scoring matches:</p>
<p><span class="math inline">\(P(X=x, Y=y) = \tau_{\lambda,\mu}(x,y)\frac{e^{-\lambda}\lambda^x}{x!}\frac{e^{-\mu}\mu^y}{y!}\)</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\lambda\)</span>: Home team’s goal expectation</li>
<li><span class="math inline">\(\mu\)</span>: Away team’s goal expectation</li>
<li><span class="math inline">\(\tau_{\lambda,\mu}(x,y)\)</span>: Correction factor accounting for dependency in low-scoring matches</li>
</ul>
<p>Dixon &amp; Coles demonstrated that the <span class="math inline">\(\tau\)</span> factor significantly improves accuracy, particularly for 0-0, 1-0, 0-1, and 1-1 scorelines, outperforming the classical Poisson model.</p>
<p>The expected goal counts for the home team (<span class="math inline">\(\lambda\)</span>) and the away team (<span class="math inline">\(\mu\)</span>) are determined based on the teams’ attacking and defensive strengths, along with the home advantage:</p>
<p><span class="math inline">\(\lambda = \alpha_i \beta_j \gamma\)</span></p>
<p><span class="math inline">\(\mu = \alpha_j \beta_i\)</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\alpha_i\)</span>: Home team’s attacking strength</li>
<li><span class="math inline">\(\beta_j\)</span>: Away team’s defensive strength</li>
<li><span class="math inline">\(\gamma\)</span>: Home advantage</li>
</ul>
</section>
<section id="correction-factor-tau_lambdamuxy" class="level3">
<h3 class="anchored" data-anchor-id="correction-factor-tau_lambdamuxy">Correction Factor <span class="math inline">\(\tau_{\lambda,\mu}(x,y)\)</span></h3>
<p>The Dixon-Coles model incorporates a correction factor to account for dependencies, particularly in low-scoring matches (e.g., 0-0, 1-0). This factor captures the dependency between goal outcomes and is defined as:</p>
<p><span class="math display">\[
\tau_{\lambda, \mu}(x, y) =
\begin{cases}
1 - \lambda \mu \rho &amp; \text{if } x = y = 0, \\
1 + \lambda \rho &amp; \text{if } x = 0, y = 1, \\
1 + \mu \rho &amp; \text{if } x = 1, y = 0, \\
1 - \rho &amp; \text{if } x = y = 1, \\
1 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
<p>Here, <span class="math inline">\(\rho\)</span> represents the dependency parameter.</p>
</section>
</section>
</section>
<section id="practical-example" class="level1">
<h1>Practical Example</h1>
<section id="season-matchweek-24-predictions" class="level2">
<h2 class="anchored" data-anchor-id="season-matchweek-24-predictions">2024/25 Season – Matchweek 24 Predictions</h2>
<p>In this section, we will implement the Dixon-Coles model step by step using Python.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading Required Libraries</h3>
<p>First, let’s load the necessary libraries. These libraries are essential for performing mathematical computations, data manipulation, and model optimization.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize, Bounds</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="preparing-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-dataset">Preparing the Dataset</h3>
<p>To apply the model, the dataset must contain information on home and away teams, along with match scores. You can access the target dataset <a href="https://github.com/urazakgul/datafc-blog/tree/main/posts/en/post3/data" target="_blank">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">"./data/tff_super_lig_2425_1-23_matches.json"</span>, lines<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This code reads the JSON dataset and converts it into a <code>pandas DataFrame</code> for further analysis.</p>
<p><img src="imgs/img2.PNG" class="img-fluid"></p>
</section>
<section id="rho_correction-function" class="level3">
<h3 class="anchored" data-anchor-id="rho_correction-function"><code>rho_correction</code> Function</h3>
<p><span class="math display">\[
\tau_{\lambda, \mu}(x, y) =
\begin{cases}
1 - \lambda \mu \rho &amp; \text{if } x = y = 0, \\
1 + \lambda \rho &amp; \text{if } x = 0, y = 1, \\
1 + \mu \rho &amp; \text{if } x = 1, y = 0, \\
1 - \rho &amp; \text{if } x = y = 1, \\
1 &amp; \text{diğer durumlarda}.
\end{cases}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rho_correction(x, y, lambda_x, mu_y, rho):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> y <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(<span class="dv">1</span> <span class="op">-</span> lambda_x <span class="op">*</span> mu_y <span class="op">*</span> rho, <span class="fl">1e-10</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> y <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> lambda_x <span class="op">*</span> rho</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> y <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> mu_y <span class="op">*</span> rho</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> y <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(<span class="dv">1</span> <span class="op">-</span> rho, <span class="fl">1e-10</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This function computes the <span class="math inline">\(\tau_{\lambda,\mu}(x,y)\)</span> correction factor used in the Dixon-Coles model.</p>
<ul>
<li>The Poisson distribution assumes independence, whereas the Dixon-Coles model accounts for dependency in low-scoring matches.</li>
<li>The <span class="math inline">\(\rho\)</span> parameter is used to model this dependency.</li>
<li>A small value like <code>max(1e-10)</code> is included to prevent division-by-zero errors during calculations.</li>
</ul>
</section>
<section id="dc_log_like-function" class="level3">
<h3 class="anchored" data-anchor-id="dc_log_like-function"><code>dc_log_like</code> Function</h3>
<p><span class="math inline">\(logP(X=x, Y=y) = log(\tau_{\lambda,\mu}(x,y))log(\frac{e^{-\lambda}\lambda^x}{x!})log(\frac{e^{-\mu}\mu^y}{y!})\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dc_log_like(x, y, alpha_x, beta_x, alpha_y, beta_y, rho, gamma):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    lambda_x <span class="op">=</span> np.exp(alpha_x <span class="op">+</span> beta_y <span class="op">+</span> gamma)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    mu_y <span class="op">=</span> np.exp(alpha_y <span class="op">+</span> beta_x)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    log_lambda_x <span class="op">=</span> np.log(<span class="bu">max</span>(poisson.pmf(x, lambda_x), <span class="fl">1e-10</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    log_mu_y <span class="op">=</span> np.log(<span class="bu">max</span>(poisson.pmf(y, mu_y), <span class="fl">1e-10</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        np.log(<span class="bu">max</span>(rho_correction(x, y, lambda_x, mu_y, rho), <span class="fl">1e-10</span>)) <span class="op">+</span> log_lambda_x <span class="op">+</span> log_mu_y</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This function computes the log-likelihood for the model.</p>
<ul>
<li><span class="math inline">\(\lambda_x\)</span> and <span class="math inline">\(\mu_y\)</span> denote the expected number of goals for each team.</li>
<li>Poisson probabilities are computed and log-transformed to prevent numerical errors due to very small values and ensure computational stability.</li>
<li>The correction factor <span class="math inline">\(\tau\)</span> is incorporated, enabling the Dixon-Coles model to outperform the classical Poisson model in predicting match outcomes.</li>
</ul>
</section>
<section id="solve_parameters-function" class="level3">
<h3 class="anchored" data-anchor-id="solve_parameters-function"><code>solve_parameters</code> Function</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_parameters(dataset, init_vals<span class="op">=</span><span class="va">None</span>, options<span class="op">=</span>{<span class="st">"disp"</span>: <span class="va">True</span>, <span class="st">"maxiter"</span>: <span class="dv">100</span>}, <span class="op">**</span>kwargs):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    teams <span class="op">=</span> np.sort(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="bu">set</span>(dataset[<span class="st">"home_team"</span>].unique()) <span class="op">|</span> <span class="bu">set</span>(dataset[<span class="st">"away_team"</span>].unique())</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    n_teams <span class="op">=</span> <span class="bu">len</span>(teams)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> init_vals <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        avg_attack <span class="op">=</span> dataset.groupby(<span class="st">"home_team"</span>)[<span class="st">"home_score"</span>].mean().reindex(teams).fillna(<span class="fl">1.0</span>).values</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        avg_defence <span class="op">=</span> <span class="op">-</span>dataset.groupby(<span class="st">"away_team"</span>)[<span class="st">"away_score"</span>].mean().reindex(teams).fillna(<span class="fl">1.0</span>).values</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        init_vals <span class="op">=</span> np.concatenate([</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            avg_attack,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            avg_defence,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            np.array([<span class="dv">0</span>, <span class="fl">1.0</span>])</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> estimate_parameters(params):</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        attack_coeffs <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(teams, params[:n_teams]))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        defence_coeffs <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(teams, params[n_teams:<span class="dv">2</span> <span class="op">*</span> n_teams]))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        rho, gamma <span class="op">=</span> params[<span class="op">-</span><span class="dv">2</span>:]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        log_likelihoods <span class="op">=</span> [</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            dc_log_like(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                row.home_score,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                row.away_score,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                attack_coeffs[row.home_team],</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                defence_coeffs[row.home_team],</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                attack_coeffs[row.away_team],</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                defence_coeffs[row.away_team],</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                rho, gamma</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> row <span class="kw">in</span> dataset.itertuples()</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>np.<span class="bu">sum</span>(log_likelihoods)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    constraints <span class="op">=</span> [{<span class="st">"type"</span>: <span class="st">"eq"</span>, <span class="st">"fun"</span>: <span class="kw">lambda</span> x, n<span class="op">=</span>n_teams: <span class="bu">sum</span>(x[:n]) <span class="op">-</span> n}]</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    bounds <span class="op">=</span> Bounds(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span>np.inf] <span class="op">*</span> n_teams <span class="op">+</span> [<span class="op">-</span>np.inf] <span class="op">*</span> n_teams <span class="op">+</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        [np.inf] <span class="op">*</span> n_teams <span class="op">+</span> [np.inf] <span class="op">*</span> n_teams <span class="op">+</span> [<span class="dv">1</span>, np.inf]</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    opt_output <span class="op">=</span> minimize(estimate_parameters, init_vals, options<span class="op">=</span>options, constraints<span class="op">=</span>constraints, bounds<span class="op">=</span>bounds, <span class="op">**</span>kwargs)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">zip</span>(</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"attack_"</span> <span class="op">+</span> team <span class="cf">for</span> team <span class="kw">in</span> teams] <span class="op">+</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"defence_"</span> <span class="op">+</span> team <span class="cf">for</span> team <span class="kw">in</span> teams] <span class="op">+</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"rho"</span>, <span class="st">"home_adv"</span>],</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>            opt_output.x</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This function optimizes the parameters of the Dixon-Coles model.</p>
<p>Initially, the attacking (<span class="math inline">\(\alpha\)</span>) and defensive (<span class="math inline">\(\beta\)</span>) coefficients for each team, as well as the home advantage (<span class="math inline">\(\gamma\)</span>) and dependency parameter (<span class="math inline">\(\rho\)</span>), are optimized.</p>
<p>The optimization process seeks to maximize the following log-likelihood function:</p>
<p><span class="math inline">\(\sum_{i=1}^{N}=logP(X_i=x_i, Y_i=y_i)\)</span></p>
<ul>
<li>The initial values for teams’ attacking and defensive strengths are based on their average performances.</li>
<li>Global parameters such as <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\gamma\)</span> are also optimized.</li>
</ul>
</section>
<section id="dixon_coles_simulate_match-function" class="level3">
<h3 class="anchored" data-anchor-id="dixon_coles_simulate_match-function"><code>dixon_coles_simulate_match</code> Function</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dixon_coles_simulate_match(params_dict, home_team, away_team, max_goals<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calc_means(param_dict, home_team, away_team):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            np.exp(param_dict[<span class="st">"attack_"</span> <span class="op">+</span> home_team] <span class="op">+</span> param_dict[<span class="st">"defence_"</span> <span class="op">+</span> away_team] <span class="op">+</span> param_dict[<span class="st">"home_adv"</span>]),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            np.exp(param_dict[<span class="st">"defence_"</span> <span class="op">+</span> home_team] <span class="op">+</span> param_dict[<span class="st">"attack_"</span> <span class="op">+</span> away_team])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    team_avgs <span class="op">=</span> calc_means(params_dict, home_team, away_team)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    team_pred <span class="op">=</span> [[poisson.pmf(i, team_avg) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(max_goals <span class="op">+</span> <span class="dv">1</span>)] <span class="cf">for</span> team_avg <span class="kw">in</span> team_avgs]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    output_matrix <span class="op">=</span> np.outer(np.array(team_pred[<span class="dv">0</span>]), np.array(team_pred[<span class="dv">1</span>]))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    correction_matrix <span class="op">=</span> np.array([</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        [rho_correction(h, a, team_avgs[<span class="dv">0</span>], team_avgs[<span class="dv">1</span>], params_dict[<span class="st">"rho"</span>]) <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>)]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> h <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    output_matrix[:<span class="dv">2</span>, :<span class="dv">2</span>] <span class="op">*=</span> correction_matrix</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This function computes the probability distribution of match scores.</p>
<p>Steps:</p>
<ol type="i">
<li><p>The Poisson distribution is used to calculate the probability of each team scoring a given number of goals.</p></li>
<li><p>These probabilities are arranged into a matrix (probability table).</p></li>
<li><p>The Dixon-Coles correction factor (<span class="math inline">\(\tau\)</span>) is applied to better model low-scoring outcomes.</p></li>
</ol>
<p>Mathematically:</p>
<p><span class="math inline">\(P(X=x, Y=y) = \tau_{\lambda,\mu}(x,y)P(X=x)P(Y=y)\)</span></p>
<p>Here, <span class="math inline">\(P(X = x)\)</span> ve <span class="math inline">\(P(Y = y)\)</span> represent the standard Poisson probabilities.</p>
<ul>
<li>The <span class="math inline">\(\tau\)</span> correction is applied only to (0-0, 1-0, 0-1, 1-1) scorelines, as Dixon and Coles originally proposed this adjustment exclusively for these cases.</li>
</ul>
<p>We can summarize the above functions as follows.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Function</strong></th>
<th><strong>Correspondence in the Dixon-Coles Model</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rho_correction</code></td>
<td>Calculates the <span class="math inline">\(\tau_{\lambda, \mu}(x, y)\)</span> correction factor.</td>
</tr>
<tr class="even">
<td><code>dc_log_like</code></td>
<td>Calculates the log-likelihood function.</td>
</tr>
<tr class="odd">
<td><code>solve_parameters</code></td>
<td>Optimizes the <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\rho\)</span>, <span class="math inline">\(\gamma\)</span> parameters.</td>
</tr>
<tr class="even">
<td><code>dixon_coles_simulate_match</code></td>
<td>Calculates the score probabilities for a match and applies the Dixon-Coles correction.</td>
</tr>
</tbody>
</table>
</section>
<section id="running-the-code" class="level3">
<h3 class="anchored" data-anchor-id="running-the-code">Running the Code</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>params_dict <span class="op">=</span> solve_parameters(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="interpreting-the-parameters" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-parameters">Interpreting the Parameters</h3>
<p><img src="imgs/img3.PNG" class="img-fluid"></p>
<p>Let’s visualize the above values on a graph.</p>
<p><img src="imgs/img4.png" class="img-fluid"></p>
<section id="teams-attacking-strengths-attack_" class="level4">
<h4 class="anchored" data-anchor-id="teams-attacking-strengths-attack_">Teams’ Attacking Strengths (attack_*)</h4>
<p>Each team’s attacking strength (attack) indicates their goal-scoring potential.</p>
<ul>
<li>Positive values: Teams with above-average attacking strength.</li>
<li>Negative values: Teams with below-average attacking strength.</li>
</ul>
</section>
<section id="teams-defensive-strengths-defence_" class="level4">
<h4 class="anchored" data-anchor-id="teams-defensive-strengths-defence_">Teams’ Defensive Strengths (defence_*)</h4>
<p>Each team’s defensive strength (defence) indicates how well they can stop opponents.</p>
<ul>
<li>Negative values: Teams with better defense (conceding fewer goals).</li>
<li>Positive values: Teams with worse defense (conceding more goals).</li>
</ul>
</section>
<section id="home-advantage-home_adv" class="level4">
<h4 class="anchored" data-anchor-id="home-advantage-home_adv">Home Advantage (<code>home_adv</code>)</h4>
<ul>
<li>Home advantage (<code>home_adv</code>) = 0.2852</li>
<li>This value is a factor that increases the home team’s goal expectation.</li>
<li>In other words, the home team’s attacking strength is estimated to be approximately 28% higher.</li>
</ul>
</section>
<section id="dependency-parameter-rho" class="level4">
<h4 class="anchored" data-anchor-id="dependency-parameter-rho">Dependency Parameter (<span class="math inline">\(\rho\)</span>)</h4>
<ul>
<li><span class="math inline">\(\rho\)</span> value = -0.2242</li>
<li>A negative <span class="math inline">\(\rho\)</span> value indicates that low-scoring matches occur more frequently than expected.</li>
<li>For example, 0-0 and 1-1 scores are more likely than predicted by the classical Poisson model.</li>
</ul>
</section>
</section>
<section id="visualizing-the-results" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-results">Visualizing the Results</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>home_team <span class="op">=</span> <span class="st">"Adana Demirspor"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>away_team <span class="op">=</span> <span class="st">"Antalyaspor"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>match_matrix <span class="op">=</span> dixon_coles_simulate_match(params_dict, home_team, away_team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="imgs/img5.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The Dixon-Coles model is a robust statistical approach for predicting football match outcomes. By accounting for teams’ attacking and defensive strengths, home advantage, and match dependencies, this model enhances prediction accuracy.</p>
<p>In this blog post, we delved into the theoretical foundations of the model and provided a step-by-step guide to its implementation in Python. I hope this post serves as a valuable resource for those looking to understand and implement the Dixon-Coles model.</p>
<p>Best regards.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>